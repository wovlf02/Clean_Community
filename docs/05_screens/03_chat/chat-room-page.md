````markdown
# 채팅방 화면 (ChatRoomPage)

**관련 문서**: [디자인 시스템](../00_common/design-system.md) | [기능 요구사항](../../02_requirements/functional.md)

---

## 1. 경로 및 접근

| 항목 | 내용 |
|------|------|
| **경로** | `/chat/[id]` |
| **접근 권한** | 채팅방 참여자만 |

---

## 2. 메시지 유형 (카카오톡 스타일)

> **레이아웃 규칙**
> - 본인 메시지: 화면 우측 정렬, 메시지 버블 좌측 바깥에 읽지 않은 수 + 전송 시각 표시
> - 상대방 메시지: 화면 좌측 정렬, 프로필 사진 + 닉네임 표시, 메시지 버블 우측 바깥에 읽지 않은 수 + 전송 시각 표시
> - **정렬 규칙**: 프로필 사진과 닉네임은 **중앙 라인 정렬** (세로 중앙 맞춤)

---

## 3. 상대방 메시지 - 중앙 라인 정렬

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  [상대방 메시지 - 프로필과 닉네임 중앙 정렬]                               │
│                                                                             │
│  ┌────┐  ┌───────────────────────────────────────────┐                      │
│  │    │  │                                           │                      │
│  │ 👤 │  │ 안녕하세요! 오늘 날씨가 정말 좋네요.      │  3                   │
│  │    │  │ 기분도 좋아지는 것 같아요 😊             │  10:30               │
│  └────┘  │                                           │                      │
│          └───────────────────────────────────────────┘                      │
│  ↑ 닉네임                                                                   │
│                                                                             │
│  [정렬 규칙]                                                                │
│  • 프로필 사진: 메시지 버블의 세로 중앙에 위치                             │
│  • 닉네임: 프로필 사진의 세로 중앙과 같은 라인                             │
│  • 프로필 + 닉네임 + 버블이 하나의 수평 그룹                               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[CSS Flexbox 정렬]
.message-row {
  display: flex;
  align-items: center;  /* 중앙 정렬 */
  gap: 8px;
}

.profile-section {
  display: flex;
  align-items: center;  /* 프로필과 닉네임 중앙 정렬 */
  gap: 8px;
}
```

---

## 4. 상대방 메시지 상세

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  [중앙 정렬 예시]                                                           │
│                                                                             │
│        ┌────────────────────────────────────────────────────────────┐       │
│        │                                                            │       │
│  ┌──┐  │  안녕하세요! 오늘 날씨가 정말 좋네요.                      │  3    │
│  │👤│  │  기분도 좋아지는 것 같아요 😊                             │ 10:30 │
│  └──┘  │  주말에 같이 나들이 가실래요?                              │       │
│   닉네임│                                                            │       │
│        └────────────────────────────────────────────────────────────┘       │
│                                                                             │
│  • 프로필 사진 (32x32px): 메시지 버블의 수직 중앙                          │
│  • 닉네임: 프로필 사진 바로 옆, 수직 중앙                                  │
│  • 읽지 않은 수 (3): 버블 우측, 시간 위                                    │
│  • 전송 시각 (10:30): 버블 우측, 버블 하단 라인                            │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 5. 본인 메시지

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  [본인 메시지 - 화면 우측 정렬]                                            │
│                                                                             │
│                                    2  ┌───────────────────────────────────┐ │
│                               10:31   │ 맞아요! 저도 오늘 기분이 좋아요~  │ │
│                                       │ 점심 뭐 드실 건가요?              │ │
│                                       └───────────────────────────────────┘ │
│              (읽지않은수)  (전송시각)   (메시지 버블)                       │
│                                                                             │
│  • 메시지 버블: 화면 우측 정렬                                             │
│  • 읽지 않은 참여자 수: 버블 좌측 바깥, 전송시각 바로 위                   │
│  • 전송 시각: 버블 좌측 바깥, 버블 하단 라인과 동일 높이                   │
│  • 본인 메시지에는 프로필/닉네임 표시 안함                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 6. 메시지 감정분석 결과 표시

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  [상대방 메시지 - 감정분석 라벨 포함]                                      │
│                                                                             │
│  ┌──┐  ┌───────────────────────────────────────────┐                       │
│  │👤│  │ 오늘 정말 기분이 좋아요!                   │  10:30               │
│  └──┘  └───────────────────────────────────────────┘                       │
│  닉네임 · 😊                                                               │
│                                                                             │
│  ─────────────────────────────────────────────────────────────────────────  │
│                                                                             │
│  [본인 메시지 - 감정분석 라벨 포함]                                        │
│                                                                             │
│                               10:31  ┌───────────────────────────────────┐ │
│                                      │ 저도요! 오늘 날씨가 좋네요 😊     │ │
│                                      └───────────────────────────────────┘ │
│                                                                         😊 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[감정분석 라벨 종류]
• 😊 긍정 - 긍정적인 내용 (초록색)
• 😐 중립 - 중립적인 내용 (회색)
• 😟 주의 - 부정적 표현 감지 (주황색)
• ⚠️ 경고 - 유해 표현 감지 (빨간색)
```

---

## 7. 이미지 메시지

```
[상대방 이미지 메시지 - 중앙 정렬]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│        ┌─────────────────────────────────┐                                 │
│  ┌──┐  │                                 │                                 │
│  │👤│  │        📷 이미지 썸네일         │  1                              │
│  └──┘  │         (최대 300px)           │  10:32                          │
│  닉네임 │                                 │                                 │
│        └─────────────────────────────────┘  ← 클릭 시 라이트박스           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[본인 이미지 메시지]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                       ┌─────────────────────────────────┐                  │
│                       │                                 │                  │
│                  1    │        📷 이미지 썸네일         │                  │
│               10:35   │         (최대 300px)           │                  │
│                       │                                 │                  │
│                       └─────────────────────────────────┘                  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 8. 읽음 상태 표시 규칙

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ※ 읽지 않은 참여자 수 표시 규칙:                                          │
│                                                                             │
│  • 1:1 채팅: 상대방이 읽으면 숫자 미표시 (읽음 처리)                        │
│  • 그룹 채팅: (전체 참여자 수 - 읽은 사람 수 - 1) = 표시할 숫자             │
│    - 예: 5명 그룹에서 2명이 읽음 → "2" 표시 (아직 2명 미읽음)               │
│    - 모두 읽으면 숫자 미표시                                               │
│                                                                             │
│  • 숫자 스타일: 작은 폰트 (12px), 색상은 포인트 컬러 (brand-500)           │
│  • 위치: 전송 시각 바로 위 (같은 X축 정렬)                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 9. AI 감정분석 경고 모달 (채팅 전용)

```
         ┌─────────────────────────────────────────────────────────┐
         │                                                         │
         │                      ⚠️                                 │
         │                                                         │
         │            유해한 표현이 감지되었습니다                  │
         │                                                         │
         │  ───────────────────────────────────────────────────   │
         │                                                         │
         │  감지된 표현 유형:                                      │
         │                                                         │
         │  ┌───────────────────────────────────────────────────┐ │
         │  │                                                   │ │
         │  │  🔴 악플/욕설 (신뢰도: 90%)                       │ │
         │  │     욕설, 비속어, 악성 표현 감지                   │ │
         │  │                                                   │ │
         │  │  🔴 여성/가족 (신뢰도: 75%)                       │ │
         │  │     여성, 가족에 대한 비하 표현 감지               │ │
         │  │                                                   │ │
         │  └───────────────────────────────────────────────────┘ │
         │                                                         │
         │  ───────────────────────────────────────────────────   │
         │                                                         │
         │  💡 상대방을 배려하는 표현으로 수정해주세요.            │
         │                                                         │
         │                                                         │
         │      [수정하기]           [그대로 전송]                 │
         │      (Primary)            (Ghost/Gray)                  │
         │                                                         │
         └─────────────────────────────────────────────────────────┘

[동작 설명]
• [수정하기] 클릭: 모달 닫힘, 메시지 입력창으로 돌아가 내용 수정 가능
• [그대로 전송] 클릭: 현재 내용 그대로 전송 처리, 모니터링 대상 등록
```

---

## 10. 입력 영역

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌────┐  ┌────┐  ┌─────────────────────────────────────────────┐  ┌────┐  │
│  │ 📎 │  │ 😀 │  │ 메시지를 입력하세요...                      │  │ ➤  │  │
│  └────┘  └────┘  └─────────────────────────────────────────────┘  └────┘  │
│  (파일)  (이모티콘)           (입력 필드)                       (전송)    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 11. Mobile 레이아웃

```
┌─────────────────────────────────┐
│ ←  👤 닉네임    ● 온라인   ⋯   │
├─────────────────────────────────┤
│                                 │
│  ────── 2026년 1월 29일 ──────  │
│                                 │
│  ┌──┐ ┌──────────────────┐      │
│  │👤│ │ 안녕하세요!      │ 10:30│
│  └──┘ └──────────────────┘      │
│  닉네임 · 😊                    │
│                                 │
│         ┌──────────────────┐    │
│  10:31  │ 반갑습니다!      │    │
│         └──────────────────┘ ✓✓ │
│                             😊 │
│                                 │
│  ┌──┐ ┌──────────────────┐      │
│  │👤│ │ 오늘 시간 되세요? │ 10:32│
│  └──┘ └──────────────────┘      │
│  닉네임 · 😐                    │
│                                 │
│         ┌──────────────────┐    │
│  10:33  │ 네, 괜찮아요!    │    │
│         └──────────────────┘ ✓✓ │
│                             😊 │
│                                 │
├─────────────────────────────────┤
│ 📎 😀  입력...           전송  │
└─────────────────────────────────┘
```

---

## 12. 날짜 구분선

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                    ────── 2026년 1월 29일 ──────                           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 13. 타이핑 표시

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌──┐  ● ● ●  (타이핑 중...)                                               │
│  │👤│                                                                       │
│  └──┘                                                                       │
│  닉네임                                                                     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

**최종 업데이트**: 2026년 1월 30일
````
