# 채팅 화면 설계

**관련 문서**: [디자인 시스템](../00_common/design-system.md) | [기능 요구사항](../../02_requirements/functional.md)

---

## 1. 채팅 목록 화면 (ChatListPage)

### 1.1 경로 및 접근
| 항목 | 내용 |
|------|------|
| **경로** | `/chat` |
| **접근 권한** | 로그인 필수 |

### 1.2 Desktop 레이아웃

```
┌─────────────────────────────────────────────────────────────────────────────────────────────┐
│                                         Header                                               │
├──────────────┬────────────────────────────────┬──────────────────────────────────────────────┤
│              │                                │                                              │
│   Sidebar    │      채팅 목록                 │           채팅방 (선택 시)                   │
│              │      (320px)                   │              (flex-1)                        │
│              │                                │                                              │
│  • 홈        │  ┌────────────────────────┐   │  ┌────────────────────────────────────────┐  │
│  • 게시판    │  │ 🔍 채팅 검색...        │   │  │  👤 닉네임                   ● 온라인  │  │
│  • 채팅  ●   │  └────────────────────────┘   │  └────────────────────────────────────────┘  │
│  • 친구      │                                │                                              │
│              │  [새 채팅] [그룹 만들기]       │  ┌────────────────────────────────────────┐  │
│              │                                │  │                                        │  │
│              │  ──────────────────────────   │  │              메시지 영역               │  │
│              │                                │  │               (스크롤)                 │  │
│              │  ┌────────────────────────┐   │  │                                        │  │
│              │  │ ● 선택된 채팅방        │   │  │     ┌───────────────────┐             │  │
│              │  │ ┌────┐                 │   │  │     │ 안녕하세요!       │             │  │
│              │  │ │ 👤 │ 닉네임1        │   │  │     └───────────────────┘ 10:30       │  │
│              │  │ └────┘ 마지막 메시지.. │   │  │                                        │  │
│              │  │        3분 전     (2)  │   │  │              ┌───────────────────┐    │  │
│              │  └────────────────────────┘   │  │              │ 네, 반갑습니다!   │    │  │
│              │                                │  │     10:31   └───────────────────┘ ✓✓ │  │
│              │  ┌────────────────────────┐   │  │                                        │  │
│              │  │ ○ 다른 채팅방          │   │  │     ┌───────────────────┐             │  │
│              │  │ ┌────┐                 │   │  │     │ 오늘 시간 되세요?  │             │  │
│              │  │ │ 👤 │ 닉네임2        │   │  │     └───────────────────┘ 10:32       │  │
│              │  │ └────┘ 네, 알겠습니다  │   │  │                                        │  │
│              │  │        10분 전         │   │  │              ┌───────────────────┐    │  │
│              │  └────────────────────────┘   │  │              │ 네, 괜찮습니다!   │    │  │
│              │                                │  │     10:33   └───────────────────┘ ✓✓ │  │
│              │  ┌────────────────────────┐   │  │                                        │  │
│              │  │ ○ 그룹 채팅            │   │  └────────────────────────────────────────┘  │
│              │  │ ┌────┐                 │   │                                              │
│              │  │ │👤👤│ 스터디 그룹    │   │  ┌────────────────────────────────────────┐  │
│              │  │ │👤👤│ 다음 모임은... │   │  │ 📎 😀  메시지를 입력하세요...    전송  │  │
│              │  │ └────┘       1시간 전  │   │  └────────────────────────────────────────┘  │
│              │  └────────────────────────┘   │                                              │
│              │                                │                                              │
└──────────────┴────────────────────────────────┴──────────────────────────────────────────────┘
```

### 1.3 채팅방 미선택 시

```
                                ┌────────────────────────────────────────┐
                                │                                        │
                                │                                        │
                                │                                        │
                                │                 💬                     │
                                │                                        │
                                │        채팅방을 선택해주세요           │
                                │                                        │
                                │     친구 목록에서 채팅을 시작하거나    │
                                │     기존 채팅방을 선택하세요          │
                                │                                        │
                                │         [새 채팅 시작하기]            │
                                │                                        │
                                │                                        │
                                └────────────────────────────────────────┘
```

### 1.4 Mobile 레이아웃

```
[채팅 목록]                     [채팅방]
┌─────────────────────────┐    ┌─────────────────────────┐
│   ☰       채팅      ✏️  │    │ ←  👤 닉네임    ● ⋯   │
├─────────────────────────┤    ├─────────────────────────┤
│                         │    │                         │
│  ┌───────────────────┐  │    │                         │
│  │ 🔍 검색...        │  │    │    ┌──────────────┐    │
│  └───────────────────┘  │    │    │ 안녕하세요!  │    │
│                         │    │    └──────────────┘    │
│  ┌───────────────────┐  │    │                 10:30  │
│  │ ● 닉네임1         │  │    │                         │
│  │   마지막 메시지.. │  │ → │         ┌──────────────┐│
│  │        3분전  (2) │  │    │         │ 반갑습니다! ││
│  └───────────────────┘  │    │  10:31  └──────────────┘│
│                         │    │                      ✓✓ │
│  ┌───────────────────┐  │    │                         │
│  │ ○ 닉네임2         │  │    │                         │
│  │   네, 알겠습니다  │  │    │                         │
│  │        10분전     │  │    ├─────────────────────────┤
│  └───────────────────┘  │    │ 📎 😀  입력...   전송  │
│                         │    └─────────────────────────┘
├─────────────────────────┤
│ 🏠  📋  💬  👥  ⋯    │
└─────────────────────────┘
```

---

## 2. 채팅방 화면 (ChatRoomPage)

### 2.1 경로 및 접근
| 항목 | 내용 |
|------|------|
| **경로** | `/chat/[id]` |
| **접근 권한** | 채팅방 참여자만 |

### 2.2 메시지 유형 (카카오톡 스타일)

> **레이아웃 규칙**
> - 본인 메시지: 화면 우측 정렬, 메시지 버블 좌측 바깥에 읽지 않은 수 + 전송 시각 표시
> - 상대방 메시지: 화면 좌측 정렬, 프로필 사진 + 닉네임 표시, 메시지 버블 우측 바깥에 읽지 않은 수 + 전송 시각 표시

```
[텍스트 메시지 - 상대방 (화면 좌측 정렬)]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌────┐  닉네임                                                             │
│  │ 👤 │  ┌───────────────────────────────────────────┐                      │
│  │    │  │ 안녕하세요! 오늘 날씨가 정말 좋네요.      │  3                   │
│  └────┘  │ 기분도 좋아지는 것 같아요 😊             │  10:30               │
│          └───────────────────────────────────────────┘                      │
│  (프로필)  (메시지 버블)                              (읽지않은수)          │
│                                                       (전송시각)            │
│                                                                             │
│  ※ 프로필 사진: 닉네임 좌측에 위치                                         │
│  ※ 닉네임: 메시지 버블 좌측 상단                                           │
│  ※ 읽지 않은 참여자 수: 버블 우측 바깥, 전송시각 바로 위                   │
│  ※ 전송 시각: 버블 우측 바깥, 버블 하단 라인과 동일 높이                   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[텍스트 메시지 - 본인 (화면 우측 정렬)]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                                    2  ┌───────────────────────────────────┐ │
│                               10:31   │ 맞아요! 저도 오늘 기분이 좋아요~  │ │
│                                       │ 점심 뭐 드실 건가요?              │ │
│                                       └───────────────────────────────────┘ │
│              (읽지않은수)  (전송시각)   (메시지 버블)                       │
│                                                                             │
│  ※ 메시지 버블: 화면 우측 정렬                                             │
│  ※ 읽지 않은 참여자 수: 버블 좌측 바깥, 전송시각 바로 위                   │
│  ※ 전송 시각: 버블 좌측 바깥, 버블 하단 라인과 동일 높이                   │
│  ※ 본인 메시지에는 프로필/닉네임 표시 안함                                 │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[이미지 메시지 - 상대방 (화면 좌측 정렬)]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌────┐  닉네임                                                             │
│  │ 👤 │  ┌─────────────────────────────────┐                               │
│  │    │  │                                 │  1                            │
│  └────┘  │        📷 이미지 썸네일         │  10:32                        │
│          │         (최대 300px)           │                                │
│          │                                 │  ← 클릭 시 라이트박스          │
│          └─────────────────────────────────┘                               │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[이미지 메시지 - 본인 (화면 우측 정렬)]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                       ┌─────────────────────────────────┐                  │
│                       │                                 │                  │
│                  1    │        📷 이미지 썸네일         │                  │
│               10:35   │         (최대 300px)           │                  │
│                       │                                 │                  │
│                       └─────────────────────────────────┘                  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[이모티콘 메시지 - 상대방]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌────┐  닉네임                                                             │
│  │ 👤 │          😂                                                        │
│  └────┘         (48px)                                               2     │
│                                                                    10:33   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[이모티콘 메시지 - 본인]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                                               😂                            │
│                                              (48px)                        │
│                                      1                                     │
│                                   10:33                                    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[읽음 상태 표시 규칙]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ※ 읽지 않은 참여자 수 표시 규칙:                                          │
│                                                                             │
│  • 1:1 채팅: 상대방이 읽으면 숫자 미표시 (읽음 처리)                        │
│  • 그룹 채팅: (전체 참여자 수 - 읽은 사람 수 - 1) = 표시할 숫자             │
│    - 예: 5명 그룹에서 2명이 읽음 → "2" 표시 (아직 2명 미읽음)               │
│    - 모두 읽으면 숫자 미표시                                               │
│                                                                             │
│  • 숫자 스타일: 작은 폰트 (12px), 색상은 포인트 컬러 (brand-500)           │
│  • 위치: 전송 시각 바로 위 (같은 X축 정렬)                                 │
│                                                                             │
│  [예시 - 그룹 채팅 5명]                                                    │
│                                                                             │
│                          3  ← 아직 3명이 안 읽음                           │
│                      10:31  ┌─────────────────────────┐                    │
│                             │ 회의 시간 정해요       │                    │
│                             └─────────────────────────┘                    │
│                                                                             │
│                             ┌─────────────────────────┐  1                 │
│                             │ 저는 3시 괜찮아요      │  10:32              │
│                             └─────────────────────────┘                    │
│                                                                             │
│                             ┌─────────────────────────┐                    │
│                             │ 저도요!                │  10:33              │
│                             └─────────────────────────┘  ← 모두 읽음       │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[날짜 구분선]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│                    ────── 2026년 1월 29일 ──────                           │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

[타이핑 표시]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌────┐                                                                     │
│  │ 👤 │  ● ● ●  (타이핑 중...)                                             │
│  └────┘                                                                     │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 2.3 입력 영역

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌────┐  ┌────┐  ┌─────────────────────────────────────────────┐  ┌────┐  │
│  │ 📎 │  │ 😀 │  │ 메시지를 입력하세요...                      │  │ ➤  │  │
│  └────┘  └────┘  └─────────────────────────────────────────────┘  └────┘  │
│  (파일)  (이모티콘)           (입력 필드)                       (전송)    │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘

### 2.4 AI 감정분석 경고 (한국어 텍스트 대상)

> **적용 시점**: 사용자가 전송 버튼 클릭 → Next.js 서버 → FastAPI 감정분석 → 악성 표현 감지 시 경고 모달 표시
> **적용 대상**: 채팅 메시지 (한국어 텍스트만)

```
         ┌─────────────────────────────────────────────────────────┐
         │                                                         │
         │                      ⚠️                                 │
         │                                                         │
         │            유해한 표현이 감지되었습니다                  │
         │                                                         │
         │  ───────────────────────────────────────────────────   │
         │                                                         │
         │  감지된 표현 유형:                                      │
         │                                                         │
         │    • 🔴 욕설/비속어 (신뢰도: 90%)                       │
         │                                                         │
         │  ───────────────────────────────────────────────────   │
         │                                                         │
         │  💡 상대방을 배려하는 표현으로 수정해주세요.            │
         │                                                         │
         │                                                         │
         │      [수정하기]           [그대로 전송]                 │
         │      (Primary)            (Ghost/Gray)                  │
         │                                                         │
         └─────────────────────────────────────────────────────────┘

[동작 설명]
• [수정하기] 클릭: 모달 닫힘, 메시지 입력창으로 돌아가 내용 수정 가능
  - 수정 후 재전송 시 다시 감정분석 수행
  - 부정적 표현이 줄어들거나 사라지면 정상 전송 처리

• [그대로 전송] 클릭: 현재 내용 그대로 전송 처리
  - 메시지 정상 전송됨
  - 백엔드에서 해당 메시지를 모니터링 대상으로 자동 플래깅
  - 시스템 관리자 대시보드에서 조회/관리 가능
```

[이모티콘 선택기]
         ┌─────────────────────────────────────────────┐
         │  최근 사용   😀   🎉   ❤️   🐱            │
         ├─────────────────────────────────────────────┤
         │                                             │
         │  😀 😂 🥹 😊 🥰 😍 🤩 😘 😗 ☺️           │
         │  😋 😛 😜 🤪 😝 🤗 🤭 🫢 🫣 🤫           │
         │  🤔 🫡 🤐 🤨 😐 😑 😶 🫠 😏 😒           │
         │  🙄 😬 🤥 😌 😔 😪 🤤 😴 😷 🤒           │
         │                                             │
         └─────────────────────────────────────────────┘

[이미지 첨부 프리뷰]
┌─────────────────────────────────────────────────────────────────────────────┐
│                                                                             │
│  ┌──────────────────┐                                                       │
│  │                  │                                                       │
│  │   📷 미리보기   ✕│                                                       │
│  │                  │                                                       │
│  └──────────────────┘                                                       │
│                                                                             │
│  ┌────┐  ┌────┐  ┌─────────────────────────────────────────────┐  ┌────┐  │
│  │ 📎 │  │ 😀 │  │ 메시지를 입력하세요...                      │  │ ➤  │  │
│  └────┘  └────┘  └─────────────────────────────────────────────┘  └────┘  │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

---

## 3. 새 채팅 만들기

### 3.1 1:1 채팅 시작 모달

```
         ┌─────────────────────────────────────────────┐
         │  새 채팅 시작                           ✕   │
         │                                             │
         │  ─────────────────────────────────────────  │
         │                                             │
         │  ┌─────────────────────────────────────┐   │
         │  │ 🔍 친구 검색...                     │   │
         │  └─────────────────────────────────────┘   │
         │                                             │
         │  온라인 친구                                │
         │                                             │
         │  ┌────┐                                    │
         │  │ 👤 │ ● 친구1                           │
         │  └────┘                                    │
         │  ┌────┐                                    │
         │  │ 👤 │ ● 친구2                           │
         │  └────┘                                    │
         │                                             │
         │  모든 친구                                  │
         │                                             │
         │  ┌────┐                                    │
         │  │ 👤 │ ○ 친구3                           │
         │  └────┘                                    │
         │  ┌────┐                                    │
         │  │ 👤 │ ○ 친구4                           │
         │  └────┘                                    │
         │                                             │
         └─────────────────────────────────────────────┘
```

### 3.2 그룹 채팅 만들기

```
         ┌─────────────────────────────────────────────┐
         │  그룹 채팅 만들기                       ✕   │
         │                                             │
         │  ─────────────────────────────────────────  │
         │                                             │
         │  그룹 이름                                  │
         │  ┌─────────────────────────────────────┐   │
         │  │ 그룹 이름을 입력하세요               │   │
         │  └─────────────────────────────────────┘   │
         │                                             │
         │  참여자 선택 (2/50)                         │
         │  ┌─────────────────────────────────────┐   │
         │  │ 🔍 친구 검색...                     │   │
         │  └─────────────────────────────────────┘   │
         │                                             │
         │  선택됨:                                    │
         │  ┌─────────┐  ┌─────────┐                  │
         │  │ 👤 친구1 ✕│  │ 👤 친구2 ✕│              │
         │  └─────────┘  └─────────┘                  │
         │                                             │
         │  친구 목록                                  │
         │  ☑ 친구1                                   │
         │  ☑ 친구2                                   │
         │  ☐ 친구3                                   │
         │  ☐ 친구4                                   │
         │                                             │
         │  ─────────────────────────────────────────  │
         │                                             │
         │         [취소]        [그룹 만들기]        │
         │                                             │
         └─────────────────────────────────────────────┘
```

---

## 4. 채팅방 헤더 옵션

```
[1:1 채팅 헤더]
┌─────────────────────────────────────────────────────────────────────────────┐
│  ←  │  👤 닉네임                                            ● 온라인   ⋯  │
└─────────────────────────────────────────────────────────────────────────────┘
                                                                          │
                                                                          ▼
                                                    ┌─────────────────────────┐
                                                    │  👤 프로필 보기         │
                                                    │  🔔 알림 끄기          │
                                                    │  🔍 대화 검색          │
                                                    │  ─────────────────────  │
                                                    │  🚪 채팅방 나가기      │
                                                    └─────────────────────────┘

[그룹 채팅 헤더]
┌─────────────────────────────────────────────────────────────────────────────┐
│  ←  │  👤👤 그룹 이름 (5)                                              ⋯  │
└─────────────────────────────────────────────────────────────────────────────┘
                                                                          │
                                                                          ▼
                                                    ┌─────────────────────────┐
                                                    │  👥 멤버 보기 (5)       │
                                                    │  ✏️ 그룹 이름 변경     │
                                                    │  ➕ 멤버 초대           │
                                                    │  🔔 알림 끄기          │
                                                    │  🔍 대화 검색          │
                                                    │  ─────────────────────  │
                                                    │  🚪 채팅방 나가기      │
                                                    └─────────────────────────┘
```

---

**최종 업데이트**: 2026년 1월 30일
